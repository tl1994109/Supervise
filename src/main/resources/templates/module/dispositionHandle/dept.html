<!DOCTYPE html>
<html lang="zh" xmlns:th="http://www.thymeleaf.org"
      xmlns:shiro="http://www.pollix.at/thymeleaf/shiro">
<meta charset="utf-8">
<head th:include="include :: header"></head>

<link th:href="@{/css/node.css}" rel="stylesheet"/>

<style type="text/css">
    .node-container{
        /*width: 300px;*/
        height: 100%;
        /*background-color: #fff;*/
        margin-top: 10px;

    }
</style>
<style type="text/css">
    .form-container {
        background-color: #fff;
        /*padding-top: 20px;*/
        overflow: hidden;
    }

    .div-middle {
        left: 50%;
        transform: translateX(-50%);
    }

    .div-title {
        height: 40px;
        line-height: 40px;
        text-align: left;
        border-bottom: 1px solid #eaeef3;
        margin-left: 20px;
        font-size: 20px;
        font-weight: 300;
    }

    .form-ul {
        left: 50%;
        transform: translateX(-50%);
        margin: 20px 0px;
    }

    .form-ul li {
        position: relative;
        display: block;
        cursor: pointer;
        float: left;
        width: 30%;
        height: 80px;
        line-height: 80px;
        text-align: center;
        border: 1px solid #eaeef3;
        box-shadow: 0px 10px 30px 0px rgba(153, 153, 153, 0.2);
    }

    @-moz-document url-prefix() {
        fieldset {
            display: table-cell;
        }
    }

    .case-wrap {
        width: 100%;
        height: auto;
        background-color: #fff;
        /*overflow: hidden;*/
    }

    .case-list {
        /*width: 100%; *!*/
        margin: 0 auto;
        height: auto;
        /*float: left;*/
        overflow: hidden;
        padding: 0px;
        /* background-color: #f3f3f3; */
        /*position: absolute;*/
        /*top: 0;*/
        /*left: -75px;*/
        /*z-index: 10;*/
    }

    .case-list ul {
        overflow: hidden;
        /*background-color: #f3f3f3;*/
        /*width: 120px;*/
        /*margin-left: 100px;*/
        /*margin: 0 auto;*/
        /*border-top: 2px solid #fff;*/
    }

    .case-list .active a {
        background-color: rgba(0, 0, 0, 0.3);
    }

    .case-list li:hover a {
        background: rgba(0, 0, 0, 0.3);
    }

    .case-list li {
        /*float: left;*/
        width: 120px;
        height: 45px;
        margin: 0 auto;
        line-height: 45px;
        text-align: center;
        background: rgba(107, 166, 217, 0.91);
        /*border-bottom: 1px solid #fff;*/
    }

    .case-list li a {
        text-decoration: none;
        /*background-color: #ecf0f1;*/
        cursor: pointer;
        font-size: 16px;
        color: #fff;
        display: block;
        border-bottom: 1px solid #fff;
        line-height: 44px;
    }

    .case-container {
        /*overflow: hidden;*/
        margin: 0 auto;
    }

    .case-container .wrap-color {
        background-color: #f3f3f3;
    }

    .group-title {
        background: #fff;
        margin: 0 auto;
        height: 50px;
        line-height: 50px;
        text-align: center;
        font-weight: 300;
        border-bottom: 2px solid #eaeef5;
    }

    .group-title h1 {
        margin: 0px;
        padding: 0px 15px;
        border-left: 6px solid #2196f3;
        line-height: 50px;

    }

    .row-container th {
        background-color: #f3f3f3;
    }

    .row-container table {
        margin: 10px 0px;
        /*width: 95%;*/
        overflow: hidden;
    }

    .row-container table th {
        /*background: #f1f1f1 !important;*/
        text-align: center;
    }

    .row-container table thead th {
        height: 40px;
        color: #fff;
        background-color: rgba(107, 166, 217, 0.91);
    }

    .row-container table thead th a {
        display: inline-block;
        line-height: 40px;
        color: inherit;
    }

    .row-container table tbody tr {
        height: 40px;
    }

    .form-ul li:hover {
        border: 1px solid #357AB8;
    }

    .form-li-line {
        width: 5%;
        float: left;
        height: 80px;
    }

    .form-ul li a {
        color: #53505f;
        font-size: 18px;
        font-weight: 300;
        cursor: pointer;
    }

    .form-ul li a .fa-text {
        padding-right: 10px;
        font-size: 20px;
    }

    .fa-ok {
        position: absolute;
        overflow: hidden;
        color: #00B83F;
        background-color: #fff;
        right: -7px;
        top: -9px;
        font-size: 20px;
    }

    .fa-not {
        position: absolute;
        overflow: hidden;
        color: #ccc;
        background-color: #fff;
        right: -7px;
        top: -9px;
        font-size: 20px;
    }
    /* 重写bootstrap tab样式  */

    .tab-title {
        width: 99px;
        margin-bottom: 20px;
        /*height: 48.15px;*/
        margin-left: 15px;
        cursor: default;
        background-color: #fff;
        border-bottom: 2px solid #2196f3;
        border-bottom-color: none;
    }
    .tab-title a{
        color: #555;
        display: block;
        padding: 14px 20px 14px 25px;
        font-weight: 600;
        border-top: none;
        border-right: none;
        border-left: none;
    }
</style>

<body class="gray-bg">
<div class="wrapper animated fadeInRight" style="height: 100%">
    <div class="col-sm-12 select-info search-collapse">
        <form class="form-horizontal form-container" style="height: 100%;" id="">
            <div class="tab-title">
                <a>基本信息</a>
            </div>
            <div class="row-container">
                <th:block th:if="${ clue.clueSource eq '2'}">
                    <table border="1" cellpadding="0" cellspacing="0" style="margin-top: 0px;margin-left: 20px;">
                        <tbody>
                        <tr align="center">
                            <th class="col-xs-1">反映人</th>
                            <td class="col-xs-2"><a href="#" style="text-decoration: underline;color: #23527c;" th:text="${dubvioEvent.dubvioFyr}"></a></td>
                            <th class="col-xs-1">反映对象</th>
                            <td class="col-xs-2" th:text="${dubvioEvent.dubvioFydx}"></td>
                            <th class="col-xs-1">反映时间</th>
                            <td class="col-xs-2" th:text="${dubvioEvent.jbxxXffysj} "></td>
                        </tr>
                        <tr align="center">
                            <th class="col-xs-1">经办法院</th>
                            <td class="col-xs-2" th:text="${dubvioEvent.jbfyId}"></td>
                            <th class="col-xs-1">线索来源</th>
                            <td class="col-xs-2" th:text="${dubvioEvent.jbxxXfly}"></td>
                            <th class="col-xs-1">反映人联系方式</th>
                            <td class="col-xs-2" th:text="${dubvioEvent.dubvioFyrdh}"></td>
                        </tr>
                        <tr align="center" rowspan="2">
                            <th class="col-xs-1">反映问题</th>
                            <td colspan="5" class="col-xs-2" style="text-align: left;"
                                th:text="${dubvioEvent.dubvioStrategyName}"></td>
                        </tr>
                        <tr align="center" rowspan="2">
                            <th class="col-xs-1">处置情况</th>
                            <td colspan="5" class="col-xs-2" style="text-align: left;"
                                th:text="${dubvioEvent.jbxxXfczjg}"></td>
                        </tr>
                        </tbody>
                    </table>
                </th:block>
                <th:block th:if="${ clue.clueSource eq '1'}">
                    <table border="1" cellpadding="0" cellspacing="0" style="margin-top: 0px;margin-left: 20px;">
                        <tbody>
                        <tr align="center">
                            <th class="col-xs-1">案号</th>
                            <td class="col-xs-2"><a href="#" style="text-decoration: underline;color: #23527c;"
                                                    onclick='clueDetail()' th:text="${clue.jbxxAh}"></a></td>
                            <th class="col-xs-1">案件类别</th>
                            <td class="col-xs-2" th:text="${clue.jbxxAjlb}"></td>
                            <th class="col-xs-1">线索来源</th>
                            <td class="col-xs-2" th:if="${clue.clueSource eq '1'} ">系统筛查</td>
                            <td class="col-xs-2" th:if="${clue.clueSource eq '2'} ">信访录入</td>
                        </tr>
                        <tr align="center">
                            <th class="col-xs-1">承办庭</th>
                            <td class="col-xs-2" th:text="${clue.jbxxCbtName}"></td>
                            <th class="col-xs-1">反映对象</th>
                            <td class="col-xs-2" th:text="${clue.jbxxCbrName}"></td>
                        </tr>
                        <tr align="center" rowspan="2">
                            <th class="col-xs-1">反映问题</th>
                            <td colspan="5" class="col-xs-2" style="text-align: left;"
                                th:text="${clue.dubvioStrategyName}"></td>
                        </tr>
                        </tbody>
                    </table>
                </th:block>
            </div>
            <div class="form-group" style="margin-left: 0px">
                <div class="tab-title" style="float: left;margin-left: 15px;">
                    <a>处置流程</a>
                </div>
                <div class="" style="float: right;margin-right: 5%">
                    <a  class="btn btn-success btn-xs " shiro:hasPermission="module:dispositionAttachment:view" onclick="findFile()" style="margin-top: 22px;padding: 5px 8px;">
                        <i class="fa fa-file-archive-o" style="padding-right: 5px;"></i>查看附件
                        <span class="icon-label label-success" id="allNewsCount" th:text="${fileSize}"></span>
                    </a>
                </div>
            </div>
            <!--<div class="form-group" style="margin-top: 30px;">-->
            <!--<div class="col-sm-12 div-title" style="margin-top: 20px;font-weight: bolder;font-family: 楷体;">-->
            <!--查看处置流程-->
            <!--<span style="float: right;margin-right: 5%;" class="btn btn-success btn-xs " onclick="findFile()"><i-->
            <!--class="fa fa-file-archive-o"></i>查看附件<span-->
            <!--class="icon-label label-success"-->
            <!--id="allNewsCount"-->
            <!--th:text="${fileSize}"></span></span>-->
            <!--</div>-->
            <!--</div>-->
            <div class="form-group">
                <input type="hidden" id="clueId" th:value="${clueId}" />
                <input type="hidden" id="czjg" th:value="${czjg}" />
                <div class="col-sm-3 node-container">
                    <div id="img_bag" class="ztb_nav ">
                        <!--<a href="javascript:void(0)" onmousedown="moveTop()" style="display:block; width:30px; margin:0 auto">-->
                        <!--<img th:src="@{/img/node/ztb_up.png}" border="0"/></a>-->
                        <div id="img" class="ztb_content">
                            <div style="position:relative;">
                                <div class="online"></div>
                                <div class="ztb_main_01" id="zc">
                                    <ul class="ztb_content_01">
                                        <li class="ztb_over" >
                                            <a href="#" class="ztb_con_text" onclick="clickli(this);">
                                                暂存待查
                                            </a>
                                            <ul class="ztb_content_02">
                                                <li  id="step3"><a href="#">问题处置分类</a></li>
                                                <li  id="step4"><a href="#">暂存待查</a></li>
                                                <li class="ztb_end" onclick="uploadFile('提交批示后附件','暂存待查','批示后附件');"><a href="#"><i
                                                        class="fa fa-upload"></i>提交批示后附件</a></li>
                                            </ul>
                                        </li>
                                    </ul>
                                </div>
                                <div class="ztb_main_01" id="lj">
                                    <ul class="ztb_content_01">
                                        <li class="ztb_over" >
                                            <a href="#" class="ztb_con_text" onclick="clickli(this);">
                                                予以了结
                                            </a>
                                            <ul class="ztb_content_02">
                                                <li  id="step1"><a href="#">问题处置分类</a></li>
                                                <li  id="step2"><a href="#">予以了结</a></li>
                                                <li class="ztb_end" onclick="uploadFile('提交批示后附件','予以了结','批示后附件');"><a href="#"><i
                                                        class="fa fa-upload"></i>提交批示后附件</a></li>
                                            </ul>
                                        </li>
                                    </ul>
                                </div>
                                <div class="ztb_main_01" id="yjsg">
                                    <ul class="ztb_content_01">
                                        <li class="ztb_over" >
                                            <a href="#" class="ztb_con_text" onclick="clickli(this);">
                                                移交审管办
                                            </a>
                                            <ul class="ztb_content_02">
                                                <li  id="step5"><a href="#">问题处置分类</a></li>
                                                <li  id="step6"><a href="#">移交审管办</a></li>
                                                <li class="ztb_end" onclick="uploadFile('提交批示后附件','移交审管办','批示后附件');"><a href="#"><i
                                                        class="fa fa-upload"></i>提交批示后附件</a></li>
                                            </ul>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <!--<a href="javascript:void(0)" onmousedown="moveBottom()" style="position:absolute; bottom:0px;left: 50%;transform: translateX(-50%)">-->
                        <!--<img th:src="@{/img/node/ztb_down.png}"  border="0"/>-->
                        <!--</a>-->
                    </div>
                </div>
                <div class="col-sm-9 select-table table-striped" style="width: 73.666667%;">
                    <table id="bootstrap-tree-table" data-mobile-responsive="true"></table>
                </div>

            </div>
        </form>
    </div>

</div>

<div th:include="include :: footer"></div>

<script th:inline="javascript">
    var addFlag = [[${@permission.hasPermi('module:dispositionHandle:add')}]];
    var editFlag = [[${@permission.hasPermi('module:dispositionHandle:edit')}]];
    var firsthandle_type = [[${@dict.getType('clue_firsthandle_type')}]];
    var datas = [[${@dict.getType('sys_notice_status')}]];
    var prefix = ctx + "module/dispositionHandle"

    $(function () {
        var options = {
            id: "deptId",
            parentId: "parentId",
            url: prefix + "/list?clueId="+$("#clueId").val(),
            createUrl: prefix + "/add/{id}",
            updateUrl: prefix + "/edit/{id}",
            removeUrl: prefix + "/remove/{id}",
            modalName: "处置过程",
            columns: [{
                field: 'deptName',
                title: '流程标题',
                align: "center",
                width: "25%"
            },
                {
                    field: 'result',
                    title: '办理方式',
                    align: "center",
                    width: "80px"
                },
                {
                    field: 'suggestion',
                    title: '意见',
                    align: "center",
                },
                {
                    field: 'status',
                    title: '状态',
                    align: 'center',
                    width: '60px',
                    formatter: function(value, row, index) {
                        var actions = [];
                        console.log(value+"----"+row.nodeFlag)
                        if (value=="1"){
                            actions.push("<span class=\"glyphicon glyphicon-ok\" style='color: green' aria-hidden=\"true\"></span>");
                            var nodeFlag=row.nodeFlag;
                            for(var i=1;i<=28;i++){
                                if(nodeFlag==i){
                                    $("#step"+i).addClass("ztb_end");
                                }
                            }
                        }
                        return actions.join('');
                    }
                },
                {
                    field: 'createBy',
                    title: '创建人',
                    align: "center",
                    width: '80px',
                },
                {
                    field: 'createTimes',
                    title: '创建时间',
                    align: "center",
                    width: '100px',
                }]
        };
        $.treeTable.init(options);
        $("#zc").css("display","none");
        $("#lj").css("display","none");
        $("#hx").css("display","none");
        $("#th").css("display","none");
        $("#cbhs").css("display","none");
        $("#yjsg").css("display","none");
        show();


    });

    var clueId=$("#clueId").val();
    function clueDetail() {
        var url = ctx + 'module/clue/edits?clueId=' + clueId;
        createMenuItem(url, "案件详情");
    }

    function findFile() {
        $.modal.open("相关附件", ctx + "module/dispositionAttachment?clueId=" + clueId);
    }

    function uploadFile(modalName,fileOfNode,fileOfStatus){
        var url=ctx+"module/dispositionAttachment/uploadFileView?clueId="+clueId+"&fileOfNode="+fileOfNode+"&fileOfStatus="+fileOfStatus;
        url=encodeURI(url);
        $.modal.open(modalName,url,400,200);
        javascript:void(0);
    }

    function show() {
        var czjg=$("#czjg").val();
        if(czjg == 3){
            $("#cbhs").css("display","block");
        }else if(czjg == 4){
            $("#th").css("display","block");
        }else if(czjg == 5){
            $("#hx").css("display","block");
        } else if(czjg == 1){
            $("#zc").css("display","block");
        }else if(czjg == 2){
            $("#lj").css("display","block");
        }else if(czjg == 11){
            $("#yjsg").css("display","block");
        }
    }
</script>
<script type="text/javascript">
    $(function () {
        $('ul.ztb_content_02 li').click(function () {

            $(this).addClass('ztb_online').siblings('li.ztb_online').removeClass('ztb_online');
            $(this).parents('li').siblings('li').children('ul').find('li.ztb_online').removeClass('ztb_online');
        })
    })
</script>
<script>
    function clickli(dom) {
        var ul = $(dom).next('ul');
        if (ul.is(":hidden")) {
            ul.css('display', 'block')
        } else {
            ul.css('display', 'none')
        }

    }
</script>
</body>
</html>